<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="920" height="420" viewBox="0 0 920 420">
  <style>
    .box { fill:#0b1f2a; stroke:#00b3f0; stroke-width:2; rx:8; }
    .text { fill:#d8e9f0; font-family:Segoe UI,Roboto,Arial,sans-serif; font-size:14px; }
    .arrow { stroke:#83d4ff; stroke-width:2; marker-end:url(#arrowhead); }
    .title { fill:#00f5d4; font-size:20px; font-weight:bold; }
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#83d4ff" />
    </marker>
  </defs>
  <text class="title" x="20" y="30">Wallet Encryption Flow</text>
  <rect class="box" x="40" y="60" width="160" height="60" />
  <text class="text" x="50" y="90">Generate Keypair</text>

  <rect class="box" x="240" y="60" width="160" height="60" />
  <text class="text" x="250" y="90">Serialize</text>

  <rect class="box" x="440" y="60" width="160" height="60" />
  <text class="text" x="450" y="90">Argon2 KDF</text>

  <rect class="box" x="640" y="60" width="160" height="60" />
  <text class="text" x="650" y="90">AES-GCM Encrypt</text>

  <line class="arrow" x1="200" y1="90" x2="240" y2="90" />
  <line class="arrow" x1="400" y1="90" x2="440" y2="90" />
  <line class="arrow" x1="600" y1="90" x2="640" y2="90" />

  <rect class="box" x="240" y="170" width="220" height="60" />
  <text class="text" x="250" y="200">Write .encrypted_key (0600)</text>

  <line class="arrow" x1="720" y1="90" x2="720" y2="170" />
  <line class="arrow" x1="460" y1="230" x2="720" y2="230" />

  <rect class="box" x="40" y="300" width="180" height="60" />
  <text class="text" x="50" y="330">Unlock (Passphrase)</text>

  <rect class="box" x="260" y="300" width="160" height="60" />
  <text class="text" x="270" y="330">Decrypt</text>

  <rect class="box" x="460" y="300" width="180" height="60" />
  <text class="text" x="470" y="330">Deserialize Keypair</text>

  <rect class="box" x="680" y="300" width="180" height="60" />
  <text class="text" x="690" y="330">Validate + Use</text>

  <line class="arrow" x1="220" y1="330" x2="260" y2="330" />
  <line class="arrow" x1="420" y1="330" x2="460" y2="330" />
  <line class="arrow" x1="640" y1="330" x2="680" y2="330" />
</svg>
